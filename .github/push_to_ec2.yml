name: Deploy HRMS
on:
  push: 
    branches:
      - fixed-master

jobs:
  deploy:
    runs-on: [self-hosted, Linux, ec2_aditya]  

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4  

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11.9"

      - name: Install Dependencies
        run: |
          python -m venv venv
          ./venv/bin/pip install -r requirements.txt  

      - name: Apply Migrations
        run: |
          ./venv/bin/python manage.py migrate

      - name: Collect Static Files
        run: |
          ./venv/bin/python manage.py collectstatic --noinput 
